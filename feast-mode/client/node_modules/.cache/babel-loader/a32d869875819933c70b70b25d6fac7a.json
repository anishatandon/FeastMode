{"ast":null,"code":"'use strict';\n\nvar util = require('util');\n\nvar Address = function (parameters) {\n  Object.defineProperties(this, {\n    parse: {\n      value: parse,\n      enumerable: true,\n      writable: false\n    },\n    getAddressLines: {\n      value: getAddressLines,\n      enumerable: true,\n      writable: false\n    },\n    Type: {\n      value: 'House',\n      enumerable: true,\n      writable: true\n    },\n    Street: {\n      value: '',\n      enumerable: true,\n      writable: true\n    },\n    City: {\n      value: '',\n      enumerable: true,\n      writable: true\n    },\n    Region: {\n      value: '',\n      enumerable: true,\n      writable: true\n    },\n    PostalCode: {\n      value: '',\n      enumerable: true,\n      writable: true\n    },\n    _init: {\n      value: init,\n      enumerable: false,\n      writable: false\n    },\n    _parameters: {\n      value: parameters,\n      enumerable: false,\n      writable: false\n    }\n  });\n\n  this._init();\n\n  function init() {\n    if (typeof this._parameters == 'object' && this._parameters.PostalCode) {\n      this.Street = this._parameters.Street;\n      this.City = this._parameters.City;\n      this.Region = this._parameters.Region;\n      this.PostalCode = this._parameters.PostalCode;\n    }\n\n    if (util.isArray(this._parameters)) {\n      this.Street = this._parameters[0];\n      this.City = this._parameters[1];\n      this.Region = this._parameters[2];\n      this.PostalCode = this._parameters[3];\n    }\n\n    if (typeof this._parameters == 'number') {\n      this._parameters += '';\n    }\n\n    if (typeof this._parameters == 'string') {\n      this.parse(this._parameters);\n    }\n\n    if (this._parameters.Type) {\n      this.Type = this._parameters.Type;\n    }\n  }\n\n  function parse(locationString) {\n    var splitAddress = locationString.split(',');\n\n    for (var i in splitAddress) {\n      splitAddress[i] = splitAddress[i].trim();\n    }\n\n    this.PostalCode = splitAddress[splitAddress.length - 1]; //need better intellegence for auto determining address parts\n    //added some, should externalize it\n    //while not perfect, it does seem to get most of the right stuff\n    //in good enough places for dominos to like it.\n\n    switch (splitAddress.length) {\n      case 1:\n        if (!this.PostalCode) {\n          this.PostalCode = '';\n          this.City = splitAddress[0];\n        }\n\n        break;\n\n      case 2:\n        if (splitAddress[0].length < 3) {\n          this.Region = splitAddress[0];\n        } else {\n          this.City = splitAddress[0];\n        }\n\n        if (!this.PostalCode) {\n          if (splitAddress[1].length > 2) {\n            if (this.City) {\n              this.Street = this.City;\n            }\n\n            this.City = splitAddress[1];\n          } else {\n            if (this.Region) {\n              this.City = this.Region;\n            }\n\n            this.Region = splitAddress[1];\n          }\n        }\n\n        break;\n\n      case 3:\n        if (splitAddress[0].length < 3) {\n          this.Region = splitAddress[0];\n        } else {\n          this.City = splitAddress[0];\n        }\n\n        if (splitAddress[1].length < 3) {\n          if (this.Region) {\n            if (this.City) {\n              this.Street = this.City;\n            }\n\n            this.City = this.Region;\n          }\n\n          this.Region = splitAddress[1];\n        } else {\n          if (this.City) {\n            this.Street = this.City;\n          }\n\n          this.City = splitAddress[1];\n        }\n\n        if (!this.PostalCode) {\n          if (splitAddress[2].length < 3) {\n            if (this.Region) {\n              if (this.City) {\n                this.Street = this.City;\n              }\n\n              this.City = this.Region;\n            }\n\n            this.Region = splitAddress[2];\n          } else {\n            if (this.City) {\n              this.Street = this.City;\n            }\n\n            this.City = splitAddress[1];\n          }\n        }\n\n        break;\n\n      case 4:\n        this.Street = splitAddress[0];\n        this.City = splitAddress[1];\n        this.Region = splitAddress[2];\n        this.PostalCode = splitAddress[3];\n    }\n\n    if (!this.PostalCode) {\n      this.PostalCode = '';\n    } //converts to string if number\n\n\n    this.PostalCode += '';\n  }\n\n  ;\n\n  function getAddressLines() {\n    var line1 = this.Street || '';\n    var line2 = (this.City ? this.City + ',' : '') + (this.Region ? this.Region + ',' : '') + this.PostalCode;\n    var lines = [line1, line2];\n    lines.line1 = line1;\n    lines.line2 = line2;\n    return lines;\n  }\n};\n\nmodule.exports = Address;","map":null,"metadata":{},"sourceType":"script"}