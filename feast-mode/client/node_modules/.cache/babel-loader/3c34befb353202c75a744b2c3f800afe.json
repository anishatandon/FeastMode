{"ast":null,"code":"'use strict'; // Load modules\n\nconst RFC3986 = require('./rfc3986'); // Declare internals\n\n\nconst internals = {\n  Ip: {\n    cidrs: {\n      required: '\\\\/(?:' + RFC3986.cidr + ')',\n      optional: '(?:\\\\/(?:' + RFC3986.cidr + '))?',\n      forbidden: ''\n    },\n    versions: {\n      ipv4: RFC3986.IPv4address,\n      ipv6: RFC3986.IPv6address,\n      ipvfuture: RFC3986.IPvFuture\n    }\n  }\n};\n\ninternals.Ip.createIpRegex = function (versions, cidr) {\n  let regex;\n\n  for (let i = 0; i < versions.length; ++i) {\n    const version = versions[i];\n\n    if (!regex) {\n      regex = '^(?:' + internals.Ip.versions[version];\n    }\n\n    regex = regex + '|' + internals.Ip.versions[version];\n  }\n\n  return new RegExp(regex + ')' + internals.Ip.cidrs[cidr] + '$');\n};\n\nmodule.exports = internals.Ip;","map":null,"metadata":{},"sourceType":"script"}